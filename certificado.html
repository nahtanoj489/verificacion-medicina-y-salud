<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>Generar Certificado</title>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<script src="api.js"></script>

</head>

<body>

<h2>Generar Certificado</h2>

<input id="nombre" placeholder="Nombre">

<input id="documento" placeholder="Documento">

<button onclick="generar()">Generar</button>

<br><br>

CÃ³digo:

<input id="codigo" readonly>

<div id="qr"></div>

<script>

function randomCode(len){

const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

let result="";

for(let i=0;i<len;i++)
result+=chars[Math.floor(Math.random()*chars.length)];

return result;

}


async function generar(){

const nombre=document.getElementById("nombre").value;

const documento=document.getElementById("documento").value;


const code=
randomCode(4)+"-"+
randomCode(4)+"-"+
randomCode(4)+"-"+
randomCode(4);


document.getElementById("codigo").value=code;


await guardarCertificado({

code,

nombre,

documento,

fecha:new Date().toISOString()

});


const url =
"verificar.html?code="+code;


const canvas=document.createElement("canvas");

QRCode.toCanvas(canvas,url);

document.getElementById("qr").innerHTML="";

document.getElementById("qr").appendChild(canvas);

}

</script>

</body>
</html>
